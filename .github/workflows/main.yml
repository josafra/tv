name: M3U Daily Checker

# 1. CU√ÅNDO se ejecuta la acci√≥n:
on:
  schedule:
    # Se ejecuta todos los d√≠as a las 03:00 AM (hora UTC). 
    # Puedes cambiar '0 3' a la hora que desees.
    - cron: '0 3 * * *' 
  workflow_dispatch:
    # Permite ejecutar manualmente la acci√≥n desde la pesta√±a 'Actions'

# 2. QU√â hace la acci√≥n:
jobs:
  check_and_update:
    runs-on: ubuntu-latest # Ejecutar en un servidor Linux

    steps:
      - name: ‚¨áÔ∏è Checkout del C√≥digo
        uses: actions/checkout@v4
        with:
          # Es crucial usar este token para permitir que el Action pueda hacer 'push'
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: üêç Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'
          
      - name: ‚öôÔ∏è Instalar Librer√≠a Requests
        run: pip install requests
        
      - name: ‚ö° Ejecutar Script de Verificaci√≥n M3U (Multi-Archivo)
        run: python check_m3u.py
        
      - name: üì§ Commit y Push de Cambios
        run: |
          git config user.name 'github-actions[bot]'
          git config user.email 'github-actions[bot]@users.noreply.github.com'
          # CORRECCI√ìN: Ahora a√±ade todos los archivos M3U modificados por el script de Python.
          git add *.m3u
          # El '|| true' evita que falle si no hubo cambios en los archivos.
          git commit -m "ü§ñ Actualizaci√≥n autom√°tica de listas M3U (canales muertos eliminados)" || true
          git push
