name: üì∫ Photocall TV Scraper

on:
  schedule:
    # Se ejecuta a las 04:00 AM UTC (una hora despu√©s del tuyo, para separar tareas)
    - cron: '0 4 * * *'
  workflow_dispatch:

jobs:
  scrape_photocall:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      
    steps:
      - name: ‚¨áÔ∏è Checkout del C√≥digo
        uses: actions/checkout@v4
        
      - name: üêç Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      # PASO CLAVE 1: Instala la dependencia de scraping
      - name: ‚öôÔ∏è Instalar Dependencias (Playwright)
        # Usamos un requirements.txt separado para no interferir con el otro workflow
        run: pip install -r requirements_scraper.txt 

      # PASO CLAVE 2: Ejecuta el nuevo script SOLO para scraping
      - name: ‚ö° Ejecutar Scraper de Photocall TV
        # Ejecuta el script que contiene la l√≥gica de Playwright
        run: python m3u_pipeline.py
        
      - name: üì§ Commit y Push de la Lista Nueva
        run: |
          git config user.name 'github-actions[bot]'
          git config user.email 'github-actions[bot]@users.noreply.github.com'
          # Guarda la nueva lista M3U generada
          git add photocall_canales.m3u
          git commit -m "ü§ñ Lista de Photocall TV actualizada" || true
          git push
